/**
 * 難易度（体感）：★★★☆☆
 * 結果：TLE
 * 解法：データの持ち方を工夫する、indexをずらす
 * * 【学んだこと・ポイント】
 * ・(a % N + N) % N の形は、円環状のインデックス操作で頻出
 * ・% 演算子は負の数を返すことがあるため、最後に + N してからもう一度 % N をとるのが定石
 * * 【反省・詰まった点】
 * ・1-indexedと剰余の相性が悪い
 * * 【計算量】
 * ・O(NQ)
 */

#include <bits/stdc++.h>
using namespace std;

long long A[1000009];
long long B[1000009];
long long T[1000009], x[1000009], y[1000009];

int main(){
  long long N,Q;
  cin >> N >> Q;
  for(int i=1;i<=N;i++){
    cin >> A[i];
  }
  for(int i=1;i<=Q;i++){
    cin >> T[i] >> x[i] >> y[i];
  }
  
  for(int i=1;i<=Q;i++){
    if(T[i] == 1){
      swap(A[x[i]], A[y[i]]);
    }
    else if(T[i] == 2){
      B[i] = A[N];
      for(int j=2;j<=N;j++){
        B[j] = A[j-1];
      }
      for(int i=j;j<=N;j++){
        A[j] = B[j];
      }      
    }
    else{
      cout << A[x[i]] << "\n";
    }
  }
}
